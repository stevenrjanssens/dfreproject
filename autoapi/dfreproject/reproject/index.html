

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>dfreproject.reproject &mdash; dfreproject  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../../_static/copybutton.js?v=f281be69"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="dfreproject.sip" href="../sip/index.html" />
    <link rel="prev" title="dfreproject.lanczos" href="../lanczos/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            dfreproject
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../methodology.html">Astronomical Coordinate Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">dfreproject</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../index.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../lanczos/index.html">dfreproject.lanczos</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">dfreproject.reproject</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sip/index.html">dfreproject.sip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tensorhdu/index.html">dfreproject.tensorhdu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/index.html">dfreproject.utils</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">dfreproject</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">API Reference</a></li>
          <li class="breadcrumb-item"><a href="../index.html">dfreproject</a></li>
      <li class="breadcrumb-item active">dfreproject.reproject</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/autoapi/dfreproject/reproject/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-dfreproject.reproject">
<span id="dfreproject-reproject"></span><h1>dfreproject.reproject<a class="headerlink" href="#module-dfreproject.reproject" title="Link to this heading"></a></h1>
<section id="attributes">
<h2>Attributes<a class="headerlink" href="#attributes" title="Link to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dfreproject.reproject.logger" title="dfreproject.reproject.logger"><code class="xref py py-obj docutils literal notranslate"><span class="pre">logger</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dfreproject.reproject.EPSILON" title="dfreproject.reproject.EPSILON"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EPSILON</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dfreproject.reproject.VALID_ORDERS" title="dfreproject.reproject.VALID_ORDERS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">VALID_ORDERS</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Link to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dfreproject.reproject.Reproject" title="dfreproject.reproject.Reproject"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Reproject</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dfreproject.reproject.validate_interpolation_order" title="dfreproject.reproject.validate_interpolation_order"><code class="xref py py-obj docutils literal notranslate"><span class="pre">validate_interpolation_order</span></code></a>(→ str)</p></td>
<td><p>Function to validate the requested interpolation order.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dfreproject.reproject.atan2d" title="dfreproject.reproject.atan2d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atan2d</span></code></a>(→ torch.Tensor)</p></td>
<td><p>PyTorch implementation of WCSLib's atan2d function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dfreproject.reproject.sincosd" title="dfreproject.reproject.sincosd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sincosd</span></code></a>(→ torch.Tensor)</p></td>
<td><p>PyTorch implementation of WCSLib's sincosd function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dfreproject.reproject.interpolate_image" title="dfreproject.reproject.interpolate_image"><code class="xref py py-obj docutils literal notranslate"><span class="pre">interpolate_image</span></code></a>(→ torch.Tensor)</p></td>
<td><p>Image interpolation using grid_sample with LANCZOS support.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dfreproject.reproject.calculate_reprojection" title="dfreproject.reproject.calculate_reprojection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_reprojection</span></code></a>(source_hdus, target_wcs[, ...])</p></td>
<td><p>Reproject an astronomical image from a source WCS to a target WCS.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading"></a></h2>
<dl class="py data">
<dt class="sig sig-object py" id="dfreproject.reproject.logger">
<span class="sig-prename descclassname"><span class="pre">dfreproject.reproject.</span></span><span class="sig-name descname"><span class="pre">logger</span></span><a class="reference internal" href="../../../_modules/dfreproject/reproject.html#logger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dfreproject.reproject.logger" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="dfreproject.reproject.EPSILON">
<span class="sig-prename descclassname"><span class="pre">dfreproject.reproject.</span></span><span class="sig-name descname"><span class="pre">EPSILON</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-10</span></em><a class="reference internal" href="../../../_modules/dfreproject/reproject.html#EPSILON"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dfreproject.reproject.EPSILON" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="dfreproject.reproject.VALID_ORDERS">
<span class="sig-prename descclassname"><span class="pre">dfreproject.reproject.</span></span><span class="sig-name descname"><span class="pre">VALID_ORDERS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['bicubic',</span> <span class="pre">'bilinear',</span> <span class="pre">'nearest',</span> <span class="pre">'nearest-neighbors',</span> <span class="pre">'lanczos']</span></em><a class="reference internal" href="../../../_modules/dfreproject/reproject.html#VALID_ORDERS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dfreproject.reproject.VALID_ORDERS" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dfreproject.reproject.validate_interpolation_order">
<span class="sig-prename descclassname"><span class="pre">dfreproject.reproject.</span></span><span class="sig-name descname"><span class="pre">validate_interpolation_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></span><a class="reference internal" href="../../../_modules/dfreproject/reproject.html#validate_interpolation_order"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dfreproject.reproject.validate_interpolation_order" title="Link to this definition"></a></dt>
<dd><p>Function to validate the requested interpolation order.</p>
<p>The order must be one of the following: “bicubic”, “bilinear”,
“nearest-neighbors”. “nearest” is an alias for “nearest-neighbors”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Interpolation order to validate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Validated interpolation order.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – When the provided order is not one of the valid interpolation orders.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dfreproject.reproject.atan2d">
<span class="sig-prename descclassname"><span class="pre">dfreproject.reproject.</span></span><span class="sig-name descname"><span class="pre">atan2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../../_modules/dfreproject/reproject.html#atan2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dfreproject.reproject.atan2d" title="Link to this definition"></a></dt>
<dd><p>PyTorch implementation of WCSLib’s atan2d function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>torch.Tensor</em>) – y coordinate(s).</p></li>
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – x coordinate(s).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>atan2d(y, x) in degrees.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dfreproject.reproject.sincosd">
<span class="sig-prename descclassname"><span class="pre">dfreproject.reproject.</span></span><span class="sig-name descname"><span class="pre">sincosd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angle_deg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../../_modules/dfreproject/reproject.html#sincosd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dfreproject.reproject.sincosd" title="Link to this definition"></a></dt>
<dd><p>PyTorch implementation of WCSLib’s sincosd function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>angle_deg</strong> (<em>torch.Tensor</em>) – angle in degrees.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>sin(angle) in degrees, cos(angle) in degrees.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a>(torch.Tensor, torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dfreproject.reproject.interpolate_image">
<span class="sig-prename descclassname"><span class="pre">dfreproject.reproject.</span></span><span class="sig-name descname"><span class="pre">interpolate_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_image</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../../_modules/dfreproject/reproject.html#interpolate_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dfreproject.reproject.interpolate_image" title="Link to this definition"></a></dt>
<dd><p>Image interpolation using grid_sample with LANCZOS support.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source_image</strong> (<em>torch.Tensor</em>) – Source image to interpolate.</p></li>
<li><p><strong>grid</strong> (<em>torch.Tensor</em>) – Grid on which to interpolate.</p></li>
<li><p><strong>interpolation_mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Interpolation mode to use. Supports PyTorch’s built-in modes
(‘bilinear’, ‘bicubic’, ‘nearest’) plus ‘lanczos’ for LANCZOS-3.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Interpolated image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dfreproject.reproject.Reproject">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dfreproject.reproject.</span></span><span class="sig-name descname"><span class="pre">Reproject</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_hdus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.astropy.org/en/stable/io/fits/api/hdus.html#astropy.io.fits.PrimaryHDU" title="(in Astropy v7.1)"><span class="pre">astropy.io.fits.PrimaryHDU</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_wcs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.wcs.WCS.html#astropy.wcs.WCS" title="(in Astropy v7.1)"><span class="pre">astropy.wcs.WCS</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_threads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conserve_flux</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_jacobian</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dfreproject/reproject.html#Reproject"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dfreproject.reproject.Reproject" title="Link to this definition"></a></dt>
<dd><dl class="py attribute">
<dt class="sig sig-object py" id="dfreproject.reproject.Reproject.requires_grad">
<span class="sig-name descname"><span class="pre">requires_grad</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="reference internal" href="../../../_modules/dfreproject/reproject.html#Reproject.requires_grad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dfreproject.reproject.Reproject.requires_grad" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dfreproject.reproject.Reproject.batch_source_images">
<span class="sig-name descname"><span class="pre">batch_source_images</span></span><a class="reference internal" href="../../../_modules/dfreproject/reproject.html#Reproject.batch_source_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dfreproject.reproject.Reproject.batch_source_images" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dfreproject.reproject.Reproject.batch_source_wcs_params">
<span class="sig-name descname"><span class="pre">batch_source_wcs_params</span></span><a class="reference internal" href="../../../_modules/dfreproject/reproject.html#Reproject.batch_source_wcs_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dfreproject.reproject.Reproject.batch_source_wcs_params" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dfreproject.reproject.Reproject.target_wcs_params">
<span class="sig-name descname"><span class="pre">target_wcs_params</span></span><a class="reference internal" href="../../../_modules/dfreproject/reproject.html#Reproject.target_wcs_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dfreproject.reproject.Reproject.target_wcs_params" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dfreproject.reproject.Reproject.target_wcs">
<span class="sig-name descname"><span class="pre">target_wcs</span></span><a class="reference internal" href="../../../_modules/dfreproject/reproject.html#Reproject.target_wcs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dfreproject.reproject.Reproject.target_wcs" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dfreproject.reproject.Reproject.target_grid">
<span class="sig-name descname"><span class="pre">target_grid</span></span><a class="reference internal" href="../../../_modules/dfreproject/reproject.html#Reproject.target_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dfreproject.reproject.Reproject.target_grid" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dfreproject.reproject.Reproject.conserve_flux">
<span class="sig-name descname"><span class="pre">conserve_flux</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="reference internal" href="../../../_modules/dfreproject/reproject.html#Reproject.conserve_flux"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dfreproject.reproject.Reproject.conserve_flux" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dfreproject.reproject.Reproject.compute_jacobian">
<span class="sig-name descname"><span class="pre">compute_jacobian</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="reference internal" href="../../../_modules/dfreproject/reproject.html#Reproject.compute_jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dfreproject.reproject.Reproject.compute_jacobian" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dfreproject.reproject.Reproject.calculate_skyCoords">
<span class="sig-name descname"><span class="pre">calculate_skyCoords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../_modules/dfreproject/reproject.html#Reproject.calculate_skyCoords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dfreproject.reproject.Reproject.calculate_skyCoords" title="Link to this definition"></a></dt>
<dd><p>Calculate sky coordinates.</p>
<p>There are four primary steps:
1. Apply shift
2. Apply SIP distortion
3. Apply CD matrix
4. Apply transformation to celestial coordinates uing the Gnomonic Projection</p>
<p>These steps use the target wcs parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_grid</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – Batch of x-coordinates. If None, uses target grid x-coordinates.</p></li>
<li><p><strong>y_grid</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – Batch of y-coordinates. If None, uses target grid y-coordinates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Batched RA and Dec coordinates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dfreproject.reproject.Reproject.calculate_sourceCoords">
<span class="sig-name descname"><span class="pre">calculate_sourceCoords</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dfreproject/reproject.html#Reproject.calculate_sourceCoords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dfreproject.reproject.Reproject.calculate_sourceCoords" title="Link to this definition"></a></dt>
<dd><p>Calculate source image pixel coordinates corresponding to each target image pixel.</p>
<p>This function repeats the same steps in self.calculate_skyCoords()
except in the opposite order and with the source coordinate wcs.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Batch of source image pixel coordinates.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dfreproject.reproject.Reproject.interpolate_source_image">
<span class="sig-name descname"><span class="pre">interpolate_source_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interpolation_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bilinear'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../../_modules/dfreproject/reproject.html#Reproject.interpolate_source_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dfreproject.reproject.Reproject.interpolate_source_image" title="Link to this definition"></a></dt>
<dd><p>Interpolate the source image at the calculated source coordinates with flux conservation.</p>
<p>This method performs the actual pixel resampling needed for dfreproject
while preserving the total flux (photometric accuracy) by using a footprint correction and the Jacobian of the transformation.</p>
<p>The method uses a combined tensor approach for computational efficiency,
performing both image resampling and footprint tracking in a single operation.
Total flux is conserved locally (via footprint correction and the Jacobian SIP calculation).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>interpolation_mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>default 'bilinear'</em>) – <p>The interpolation mode to use when sampling the source image.
Options include:
- ‘nearest’ : Nearest neighbor interpolation (no interpolation)
- ‘bilinear’ : Bilinear interpolation (default)
- ‘bicubic’ : Bicubic interpolation
- ‘lanczos’ : Lanczos interpolation</p>
<p>These correspond to the modes available in torch.nn.functional.grid_sample.</p>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The reprojected image with the same shape as the target image.
Pixel values are interpolated from the source image according to
the WCS transformation with flux conservation preserved.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This implementation uses a two-step flux conservation approach:</p>
<ol class="arabic simple">
<li><p>Local flux density conservation: The image and a “ones” tensor are interpolated
together, and the interpolated image is divided by the interpolated ones
tensor (footprint) to correct for any flux density spreading during interpolation.
This is important when for pixels at the edge of the input image when mapped to the output
image in case the input image only partially fills the output pixel.</p></li>
<li><p>Jacobian correction for full flux conservation: Multiply the footprint-corrected flux
by the determinant of the Jacobian to handle changes in area during the reprojection</p></li>
</ol>
<p>The Jacobian correction can be circumvented if you set
compute_jacobian=False. However, the default behavior is to include this.</p>
<p>Areas in the target image that map outside the source image boundaries
will be filled with NaNs.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dfreproject.reproject.calculate_reprojection">
<span class="sig-prename descclassname"><span class="pre">dfreproject.reproject.</span></span><span class="sig-name descname"><span class="pre">calculate_reprojection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_hdus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.astropy.org/en/stable/io/fits/api/hdus.html#astropy.io.fits.PrimaryHDU" title="(in Astropy v7.1)"><span class="pre">astropy.io.fits.PrimaryHDU</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../tensorhdu/index.html#dfreproject.tensorhdu.TensorHDU" title="dfreproject.tensorhdu.TensorHDU"><span class="pre">dfreproject.tensorhdu.TensorHDU</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">numpy.ndarray</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.wcs.WCS.html#astropy.wcs.WCS" title="(in Astropy v7.1)"><span class="pre">astropy.wcs.WCS</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.astropy.org/en/stable/io/fits/api/headers.html#astropy.io.fits.Header" title="(in Astropy v7.1)"><span class="pre">astropy.io.fits.Header</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.wcs.WCS.html#astropy.wcs.WCS" title="(in Astropy v7.1)"><span class="pre">astropy.wcs.WCS</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.astropy.org/en/stable/io/fits/api/headers.html#astropy.io.fits.Header" title="(in Astropy v7.1)"><span class="pre">astropy.io.fits.Header</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.astropy.org/en/stable/io/fits/api/hdus.html#astropy.io.fits.PrimaryHDU" title="(in Astropy v7.1)"><span class="pre">astropy.io.fits.PrimaryHDU</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">numpy.ndarray</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.wcs.WCS.html#astropy.wcs.WCS" title="(in Astropy v7.1)"><span class="pre">astropy.wcs.WCS</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.astropy.org/en/stable/io/fits/api/headers.html#astropy.io.fits.Header" title="(in Astropy v7.1)"><span class="pre">astropy.io.fits.Header</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_wcs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.wcs.WCS.html#astropy.wcs.WCS" title="(in Astropy v7.1)"><span class="pre">astropy.wcs.WCS</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.astropy.org/en/stable/io/fits/api/headers.html#astropy.io.fits.Header" title="(in Astropy v7.1)"><span class="pre">astropy.io.fits.Header</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'nearest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_threads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conserve_flux</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_jacobian</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory_mb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_safety_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_chunk_progress</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dfreproject/reproject.html#calculate_reprojection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dfreproject.reproject.calculate_reprojection" title="Link to this definition"></a></dt>
<dd><p>Reproject an astronomical image from a source WCS to a target WCS.</p>
<p>This high-level function provides a convenient interface for image reprojection,
handling all the necessary steps: WCS extraction, tensor creation, and interpolation.
It converts FITS HDU objects to the internal representation, performs the reprojection,
and returns the resulting image as a NumPy array or PyTorch tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>source_hdus</strong> (<em>PrimaryHDU</em><em>, </em><a class="reference internal" href="../tensorhdu/index.html#dfreproject.tensorhdu.TensorHDU" title="dfreproject.tensorhdu.TensorHDU"><em>TensorHDU</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em>, or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a>) – <dl class="simple">
<dt>The source image(s) to be reprojected. Can be:</dt><dd><ul class="simple">
<li><p>A PrimaryHDU</p></li>
<li><p>A TensorHDU</p></li>
<li><p>A tuple of (np.ndarray or torch.Tensor, WCS or Header)</p></li>
<li><p>A list of any of the above</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
</dl>
<dl class="simple">
<dt>target_wcs<span class="classifier">Union[WCS, Header]</span></dt><dd><p>WCS information for the target. If a Header is passed it will be converted to WCS.</p>
</dd>
<dt>shape_out: Optional[Tuple[int, int]]</dt><dd><p>Shape of the resampled array. If not provided, the output shape will match the input.</p>
</dd>
<dt>order<span class="classifier">str, default ‘nearest’</span></dt><dd><p>The interpolation method to use when resampling the source image.
Options:
- ‘nearest’ : Nearest neighbor interpolation (fastest, default)
- ‘bilinear’ : Bilinear interpolation (good balance of speed/quality)
- ‘bicubic’ : Bicubic interpolation (high quality, slow)
- ‘lanczos’ : Lanczos 3-lobe interpolation (highest quality, slowest)</p>
</dd>
<dt>device: str, optional</dt><dd><p>Device to use for computations. Defaults to GPU if available, otherwise uses CPU.</p>
</dd>
<dt>num_threads: int, optional</dt><dd><p>Number of threads to use on CPU.</p>
</dd>
<dt>requires_grad: bool, optional</dt><dd><p>If True, enables autograd for PyTorch tensors.</p>
</dd>
<dt>conserve_flux: bool, optional</dt><dd><p>If True, enables flux conservation through footprint calculations.
By default, this is set to True.</p>
</dd>
<dt>compute_jacobian: bool, optional</dt><dd><p>If True, enables non-linear flux conservation through Jacobian calculation. Note
that this slightly increases RAM usage.
By default, this is set to True.
If there is no SIP distortion, users can set this to False.</p>
</dd>
<dt>max_memory_mb: Optional[float], optional</dt><dd><p>Maximum memory to use in megabytes for chunked processing. If None (default),
processes the entire image at once without chunking. Set this to enable
memory-limited chunked processing (e.g., 1000 for 1GB limit).</p>
</dd>
<dt>chunk_safety_factor: float, optional</dt><dd><p>Safety factor (0-1) for chunked processing. Default 0.8 means use 80% of
max_memory_mb for actual data, leaving 20% margin. Only used if max_memory_mb is set.</p>
</dd>
<dt>show_chunk_progress: bool, optional</dt><dd><p>Whether to log progress when using chunked processing. Default True.
Only used if max_memory_mb is set.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The reprojected image as a numpy ndarray (default) or PyTorch tensor if
requires_grad=True.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)">numpy.ndarray</a> or torch.Tensor</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function automatically:
- Detects and uses GPU acceleration if available
- Handles byte order conversion for tensor creation
- Converts data to float64 for processing
- Converts Header to WCS if needed
- Processes in memory-constrained chunks if max_memory_mb is specified</p>
<p><strong>Chunked Processing:</strong>
When max_memory_mb is set, the reprojection is computed in blocks to stay within
the specified memory limit. This is useful for:
- Very large output images
- Limited GPU memory
- Batch processing multiple images</p>
<p>To save the result as a FITS file, convert the tensor back to a NumPy array
and create a new FITS HDU with the target WCS header.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">astropy.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">fits</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">astropy.wcs</span><span class="w"> </span><span class="kn">import</span> <span class="n">WCS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">dfreproject.reproject</span><span class="w"> </span><span class="kn">import</span> <span class="n">calculate_reprojection</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Open source and target images</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source_hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;source_image.fits&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;target_grid.fits&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_wcs</span> <span class="o">=</span> <span class="n">WCS</span><span class="p">(</span><span class="n">target_hdu</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Perform reprojection with bilinear interpolation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reprojected</span> <span class="o">=</span> <span class="n">calculate_reprojection</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">source_hdus</span><span class="o">=</span><span class="n">source_hdu</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">target_wcs</span><span class="o">=</span><span class="n">target_wcs</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">shape_out</span><span class="o">=</span><span class="n">target_hdu</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">order</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Perform chunked reprojection with 2GB memory limit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reprojected</span> <span class="o">=</span> <span class="n">calculate_reprojection</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">source_hdus</span><span class="o">=</span><span class="n">source_hdu</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">target_wcs</span><span class="o">=</span><span class="n">target_wcs</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">shape_out</span><span class="o">=</span><span class="p">(</span><span class="mi">8000</span><span class="p">,</span> <span class="mi">8000</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">order</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">max_memory_mb</span><span class="o">=</span><span class="mi">2000</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Save as FITS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">PrimaryHDU</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">reprojected</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">target_hdu</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_hdu</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s1">&#39;reprojected_image.fits&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../lanczos/index.html" class="btn btn-neutral float-left" title="dfreproject.lanczos" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../sip/index.html" class="btn btn-neutral float-right" title="dfreproject.sip" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Carter Rhea.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>